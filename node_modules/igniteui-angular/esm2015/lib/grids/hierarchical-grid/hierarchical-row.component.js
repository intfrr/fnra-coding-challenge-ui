import { ChangeDetectionStrategy, Component, HostBinding, forwardRef, ElementRef, ViewChildren, ViewChild, TemplateRef } from '@angular/core';
import { IgxRowDirective } from '../row.directive';
import { IgxHierarchicalGridCellComponent } from './hierarchical-cell.component';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';
import * as ɵngcc2 from '../../icon/icon.component';
import * as ɵngcc3 from '../../directives/for-of/for_of.directive';
import * as ɵngcc4 from '../row-drag.directive';
import * as ɵngcc5 from './hierarchical-cell.component';
import * as ɵngcc6 from '../../checkbox/checkbox.component';
import * as ɵngcc7 from '../common/pipes';

const _c0 = ["expander"];
const _c1 = ["defaultExpandedTemplate"];
const _c2 = ["defaultEmptyTemplate"];
const _c3 = ["defaultCollapsedTemplate"];
function IgxHierarchicalRowComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function IgxHierarchicalRowComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "igx-icon", 6);
    ɵngcc0.ɵɵtext(1, "expand_more");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("isActive", !ctx_r2.added);
} }
function IgxHierarchicalRowComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "igx-icon", 6);
    ɵngcc0.ɵɵtext(1, "chevron_right");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("isActive", !ctx_r4.added);
} }
function IgxHierarchicalRowComponent_ng_template_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "igx-icon", 7);
} }
function IgxHierarchicalRowComponent_ng_template_7_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function IgxHierarchicalRowComponent_ng_template_7_Template(rf, ctx) { if (rf & 1) {
    const _r13 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 8);
    ɵngcc0.ɵɵlistener("animationend", function IgxHierarchicalRowComponent_ng_template_7_Template_div_animationend_0_listener() { ɵngcc0.ɵɵrestoreView(_r13); const ctx_r12 = ɵngcc0.ɵɵnextContext(); return ctx_r12.animationEndHandler(); });
    ɵngcc0.ɵɵtemplate(1, IgxHierarchicalRowComponent_ng_template_7_ng_container_1_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r8 = ɵngcc0.ɵɵnextContext();
    const _r9 = ɵngcc0.ɵɵreference(10);
    ɵngcc0.ɵɵclassProp("igx-grid__tr--add-animate", ctx_r8.animateAdd);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r9);
} }
function IgxHierarchicalRowComponent_ng_template_9_div_0_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
const _c4 = function (a0) { return { $implicit: a0 }; };
function IgxHierarchicalRowComponent_ng_template_9_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r28 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 15, 16);
    ɵngcc0.ɵɵlistener("click", function IgxHierarchicalRowComponent_ng_template_9_div_0_Template_div_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r28); const ctx_r27 = ɵngcc0.ɵɵnextContext(2); return ctx_r27.expanderClick($event); })("mousedown", function IgxHierarchicalRowComponent_ng_template_9_div_0_Template_div_mousedown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r28); return $event.preventDefault(); });
    ɵngcc0.ɵɵtemplate(2, IgxHierarchicalRowComponent_ng_template_9_div_0_ng_container_2_Template, 1, 0, "ng-container", 17);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r14 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r14.expanderClassResolved);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r14.iconTemplate)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(3, _c4, ctx_r14));
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    const _r32 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 18);
    ɵngcc0.ɵɵlistener("click", function IgxHierarchicalRowComponent_ng_template_9_ng_container_1_Template_div_click_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r32); return $event.stopPropagation(); })("pointerdown", function IgxHierarchicalRowComponent_ng_template_9_ng_container_1_Template_div_pointerdown_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r32); return $event.preventDefault(); });
    ɵngcc0.ɵɵtemplate(2, IgxHierarchicalRowComponent_ng_template_9_ng_container_1_ng_container_2_Template, 1, 0, "ng-container", 0);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r15 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵclassMap(ctx_r15.resolveDragIndicatorClasses);
    ɵngcc0.ɵɵproperty("igxRowDrag", ctx_r15)("ghostTemplate", ctx_r15.grid.getDragGhostCustomTemplate());
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r15.grid.dragIndicatorIconTemplate ? ctx_r15.grid.dragIndicatorIconTemplate : ctx_r15.grid.dragIndicatorIconBase);
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_2_2_ng_template_0_Template(rf, ctx) { }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_2_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, IgxHierarchicalRowComponent_ng_template_9_ng_container_2_2_ng_template_0_Template, 0, 0, "ng-template");
} }
const _c5 = function (a0, a1, a2, a3, a4) { return { index: a0, rowID: a1, selected: a2, select: a3, deselect: a4 }; };
function IgxHierarchicalRowComponent_ng_template_9_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    const _r37 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 19);
    ɵngcc0.ɵɵlistener("click", function IgxHierarchicalRowComponent_ng_template_9_ng_container_2_Template_div_click_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r37); const ctx_r36 = ɵngcc0.ɵɵnextContext(2); return ctx_r36.onRowSelectorClick($event); })("pointerdown", function IgxHierarchicalRowComponent_ng_template_9_ng_container_2_Template_div_pointerdown_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r37); return $event.preventDefault(); });
    ɵngcc0.ɵɵtemplate(2, IgxHierarchicalRowComponent_ng_template_9_ng_container_2_2_Template, 1, 0, undefined, 17);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵnextContext();
    const _r21 = ɵngcc0.ɵɵreference(9);
    const ctx_r16 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r16.grid.rowSelectorTemplate ? ctx_r16.grid.rowSelectorTemplate : _r21)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(8, _c4, ɵngcc0.ɵɵpureFunction5(2, _c5, ctx_r16.viewIndex, ctx_r16.rowID, ctx_r16.selected, ctx_r16.select, ctx_r16.deselect)));
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_3_1_ng_template_0_Template(rf, ctx) { }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_3_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, IgxHierarchicalRowComponent_ng_template_9_ng_container_3_1_ng_template_0_Template, 0, 0, "ng-template");
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, IgxHierarchicalRowComponent_ng_template_9_ng_container_3_1_Template, 1, 0, undefined, 17);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵnextContext();
    const _r23 = ɵngcc0.ɵɵreference(11);
    const ctx_r17 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r23)("ngTemplateOutletContext", ctx_r17);
} }
const _c6 = function (a0, a1, a2, a3, a4, a5, a6) { return [a0, a1, a2, a3, a4, a5, a6]; };
const _c7 = function (a0, a1, a2, a3, a4, a5) { return [a0, a1, a2, a3, a4, a5]; };
function IgxHierarchicalRowComponent_ng_template_9_ng_template_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "igx-hierarchical-grid-cell", 20);
    ɵngcc0.ɵɵpipe(1, "transactionState");
    ɵngcc0.ɵɵpipe(2, "igxStringReplace");
    ɵngcc0.ɵɵpipe(3, "igxCellStyleClasses");
    ɵngcc0.ɵɵpipe(4, "igxCellStyles");
    ɵngcc0.ɵɵpipe(5, "dataMapper");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const col_r41 = ctx.$implicit;
    const ctx_r19 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵstyleProp("min-height", ctx_r19.cellHeight, "px")("min-width", col_r41.width)("max-width", col_r41.width)("flex-basis", col_r41.width);
    ɵngcc0.ɵɵclassProp("igx-grid__td--edited", ɵngcc0.ɵɵpipeBindV(1, 30, ɵngcc0.ɵɵpureFunction7(60, _c6, ctx_r19.rowID, col_r41.field, ctx_r19.grid.rowEditable, ctx_r19.grid.transactions, ctx_r19.grid.pipeTrigger, ctx_r19.grid.crudService.cell, ctx_r19.grid.crudService.row)))("igx-grid__td--number", col_r41.dataType === "number")("igx-grid__td--bool", col_r41.dataType === "boolean");
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpipeBindV(3, 42, ɵngcc0.ɵɵpureFunction6(68, _c7, col_r41.cellClasses, ctx_r19.rowData[col_r41.field], ctx_r19.rowData, col_r41.field, ctx_r19.viewIndex, ctx_r19.grid.pipeTrigger)))("ngStyle", ɵngcc0.ɵɵpipeBindV(4, 49, ɵngcc0.ɵɵpureFunction6(75, _c7, col_r41.cellStyles, ctx_r19.rowData[col_r41.field], ctx_r19.rowData, col_r41.field, ctx_r19.viewIndex, ctx_r19.grid.pipeTrigger)))("editMode", col_r41.editable && ctx_r19.crudService.targetInEdit(ctx_r19.index, col_r41.index))("column", col_r41)("formatter", col_r41.formatter)("row", ctx_r19)("active", ctx_r19.isCellActive(col_r41.visibleIndex))("rowData", ctx_r19.rowData)("width", col_r41.getCellWidth())("visibleColumnIndex", col_r41.visibleIndex)("value", ɵngcc0.ɵɵpipeBind3(5, 56, ctx_r19.rowData, col_r41.field, ctx_r19.grid.pipeTrigger))("cellTemplate", col_r41.bodyTemplate)("lastSearchInfo", ctx_r19.grid.lastSearchInfo)("cellSelectionMode", ctx_r19.grid.cellSelection)("displayPinnedChip", ctx_r19.shouldDisplayPinnedChip(col_r41.visibleIndex));
    ɵngcc0.ɵɵattribute("aria-describedby", ɵngcc0.ɵɵpipeBind3(2, 38, ctx_r19.gridID + "_" + col_r41.field, ".", "_"));
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_7_1_ng_template_0_Template(rf, ctx) { }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_7_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, IgxHierarchicalRowComponent_ng_template_9_ng_container_7_1_ng_template_0_Template, 0, 0, "ng-template");
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_container_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, IgxHierarchicalRowComponent_ng_template_9_ng_container_7_1_Template, 1, 0, undefined, 17);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵnextContext();
    const _r23 = ɵngcc0.ɵɵreference(11);
    const ctx_r20 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", _r23)("ngTemplateOutletContext", ctx_r20);
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_template_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 21);
    ɵngcc0.ɵɵelement(1, "igx-checkbox", 22);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r22 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("tabindex", -1)("readonly", true)("checked", ctx_r22.selected)("disabled", ctx_r22.deleted)("disableTransitions", ctx_r22.grid.disableTransitions)("aria-label", ctx_r22.rowCheckboxAriaLabel);
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_template_10_igx_hierarchical_grid_cell_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "igx-hierarchical-grid-cell", 24);
    ɵngcc0.ɵɵpipe(1, "transactionState");
    ɵngcc0.ɵɵpipe(2, "igxStringReplace");
    ɵngcc0.ɵɵpipe(3, "igxCellStyleClasses");
    ɵngcc0.ɵɵpipe(4, "igxCellStyles");
    ɵngcc0.ɵɵpipe(5, "dataMapper");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const col_r47 = ctx.$implicit;
    const ctx_r46 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵstyleProp("min-height", ctx_r46.cellHeight, "px")("min-width", col_r47.width)("max-width", col_r47.width)("flex-basis", col_r47.width)("left", col_r47.rightPinnedOffset);
    ɵngcc0.ɵɵclassProp("igx-grid__td--edited", ɵngcc0.ɵɵpipeBindV(1, 32, ɵngcc0.ɵɵpureFunction7(62, _c6, ctx_r46.rowID, col_r47.field, ctx_r46.grid.rowEditable, ctx_r46.grid.transactions, ctx_r46.grid.pipeTrigger, ctx_r46.grid.crudService.cell, ctx_r46.grid.crudService.row)))("igx-grid__td--number", col_r47.dataType === "number");
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpipeBindV(3, 44, ɵngcc0.ɵɵpureFunction6(70, _c7, col_r47.cellClasses, ctx_r46.rowData[col_r47.field], ctx_r46.rowData, col_r47.field, ctx_r46.viewIndex, ctx_r46.grid.pipeTrigger)))("ngStyle", ɵngcc0.ɵɵpipeBindV(4, 51, ɵngcc0.ɵɵpureFunction6(77, _c7, col_r47.cellStyles, ctx_r46.rowData[col_r47.field], ctx_r46.rowData, col_r47.field, ctx_r46.viewIndex, ctx_r46.grid.pipeTrigger)))("editMode", col_r47.editable && ctx_r46.crudService.targetInEdit(ctx_r46.index, col_r47.index))("column", col_r47)("formatter", col_r47.formatter)("row", ctx_r46)("active", ctx_r46.isCellActive(col_r47.visibleIndex))("firstPinned", col_r47.isFirstPinned)("lastPinned", col_r47.isLastPinned)("rowData", ctx_r46.rowData)("width", col_r47.getCellWidth())("visibleColumnIndex", col_r47.visibleIndex)("value", ɵngcc0.ɵɵpipeBind3(5, 58, ctx_r46.rowData, col_r47.field, ctx_r46.grid.pipeTrigger))("cellTemplate", col_r47.bodyTemplate)("lastSearchInfo", ctx_r46.grid.lastSearchInfo)("cellSelectionMode", ctx_r46.grid.cellSelection)("displayPinnedChip", ctx_r46.shouldDisplayPinnedChip(col_r47.visibleIndex));
    ɵngcc0.ɵɵattribute("aria-describedby", ɵngcc0.ɵɵpipeBind3(2, 40, ctx_r46.gridID + "_" + col_r47.field, ".", "_"));
} }
function IgxHierarchicalRowComponent_ng_template_9_ng_template_10_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, IgxHierarchicalRowComponent_ng_template_9_ng_template_10_igx_hierarchical_grid_cell_0_Template, 6, 84, "igx-hierarchical-grid-cell", 23);
    ɵngcc0.ɵɵpipe(1, "igxNotGrouped");
} if (rf & 2) {
    const ctx_r24 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(1, 1, ctx_r24.pinnedColumns));
} }
function IgxHierarchicalRowComponent_ng_template_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, IgxHierarchicalRowComponent_ng_template_9_div_0_Template, 3, 5, "div", 9);
    ɵngcc0.ɵɵtemplate(1, IgxHierarchicalRowComponent_ng_template_9_ng_container_1_Template, 3, 5, "ng-container", 10);
    ɵngcc0.ɵɵtemplate(2, IgxHierarchicalRowComponent_ng_template_9_ng_container_2_Template, 3, 10, "ng-container", 10);
    ɵngcc0.ɵɵtemplate(3, IgxHierarchicalRowComponent_ng_template_9_ng_container_3_Template, 2, 2, "ng-container", 10);
    ɵngcc0.ɵɵtemplate(4, IgxHierarchicalRowComponent_ng_template_9_ng_template_4_Template, 6, 82, "ng-template", 11, 12, ɵngcc0.ɵɵtemplateRefExtractor);
    ɵngcc0.ɵɵpipe(6, "igxNotGrouped");
    ɵngcc0.ɵɵtemplate(7, IgxHierarchicalRowComponent_ng_template_9_ng_container_7_Template, 2, 2, "ng-container", 10);
    ɵngcc0.ɵɵtemplate(8, IgxHierarchicalRowComponent_ng_template_9_ng_template_8_Template, 2, 6, "ng-template", null, 13, ɵngcc0.ɵɵtemplateRefExtractor);
    ɵngcc0.ɵɵtemplate(10, IgxHierarchicalRowComponent_ng_template_9_ng_template_10_Template, 2, 3, "ng-template", null, 14, ɵngcc0.ɵɵtemplateRefExtractor);
} if (rf & 2) {
    const ctx_r10 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r10.hasChildren);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r10.rowDraggable);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r10.showRowSelectors);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r10.pinnedColumns.length > 0 && ctx_r10.grid.isPinningToStart);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("igxGridForOf", ɵngcc0.ɵɵpipeBind1(6, 11, ctx_r10.unpinnedColumns))("igxForScrollContainer", ctx_r10.grid.parentVirtDir)("igxForSizePropName", "calcPixelWidth")("igxForScrollOrientation", "horizontal")("igxForContainerSize", ctx_r10.grid.unpinnedWidth)("igxForTrackBy", ctx_r10.grid.trackColumnChanges);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r10.pinnedColumns.length > 0 && !ctx_r10.grid.isPinningToStart);
} }
export class IgxHierarchicalRowComponent extends IgxRowDirective {
    constructor() {
        super(...arguments);
        this.expanderClass = 'igx-grid__hierarchical-expander';
        /**
         * @hidden
         * @internal
         */
        this.select = () => {
            this.grid.selectRows([this.rowID]);
        };
        /**
         * @hidden
         * @internal
         */
        this.deselect = () => {
            this.grid.deselectRows([this.rowID]);
        };
    }
    /**
     * @hidden
     */
    get expanderClassResolved() {
        return {
            [this.expanderClass]: !this.pinned || this.disabled,
            [`${this.expanderClass}--empty`]: this.pinned && !this.disabled
        };
    }
    get viewIndex() {
        return this.index + this.grid.page * this.grid.perPage;
    }
    /**
     * Returns whether the row is expanded.
     * ```typescript
     * const RowExpanded = this.grid1.rowList.first.expanded;
     * ```
     */
    get expanded() {
        return this.gridAPI.get_row_expansion_state(this.rowData);
    }
    /**
     * @hidden
     */
    get expandedClass() {
        return this.expanded && !this.pinned;
    }
    get hasChildren() {
        return !!this.grid.childLayoutKeys.length;
    }
    /**
     * @hidden
     */
    get highlighted() {
        return this.grid && this.grid.highlightedRowID === this.rowID;
    }
    /**
     * @hidden
     */
    expanderClick(event) {
        event.stopPropagation();
        this.toggle();
    }
    /**
     * Toggles the hierarchical row.
     * ```typescript
     * this.grid1.rowList.first.toggle()
     * ```
     */
    toggle() {
        if (this.added) {
            return;
        }
        const grid = this.gridAPI.grid;
        this.endEdit(grid.rootGrid);
        this.gridAPI.set_row_expansion_state(this.rowID, !this.expanded);
        grid.cdr.detectChanges();
    }
    /**
     * @hidden
     */
    get iconTemplate() {
        let expandable = true;
        if (this.grid.hasChildrenKey) {
            expandable = this.rowData[this.grid.hasChildrenKey];
        }
        if (!expandable || (this.pinned && !this.disabled)) {
            return this.defaultEmptyTemplate;
        }
        if (this.expanded) {
            return this.grid.rowExpandedIndicatorTemplate || this.defaultExpandedTemplate;
        }
        else {
            return this.grid.rowCollapsedIndicatorTemplate || this.defaultCollapsedTemplate;
        }
    }
    endEdit(grid) {
        if (grid.crudService.cellInEditMode) {
            grid.endEdit();
        }
        grid.hgridAPI.getChildGrids(true).forEach(g => {
            if (g.crudService.cellInEditMode) {
                g.endEdit();
            }
        });
    }
}
IgxHierarchicalRowComponent.ɵfac = function IgxHierarchicalRowComponent_Factory(t) { return ɵIgxHierarchicalRowComponent_BaseFactory(t || IgxHierarchicalRowComponent); };
IgxHierarchicalRowComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: IgxHierarchicalRowComponent, selectors: [["igx-hierarchical-grid-row"]], viewQuery: function IgxHierarchicalRowComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, true, ElementRef);
        ɵngcc0.ɵɵstaticViewQuery(_c1, true, TemplateRef);
        ɵngcc0.ɵɵstaticViewQuery(_c2, true, TemplateRef);
        ɵngcc0.ɵɵstaticViewQuery(_c3, true, TemplateRef);
        ɵngcc0.ɵɵviewQuery(IgxHierarchicalGridCellComponent, true, IgxHierarchicalGridCellComponent);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.expander = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.defaultExpandedTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.defaultEmptyTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.defaultCollapsedTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx._cells = _t);
    } }, hostVars: 4, hostBindings: function IgxHierarchicalRowComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("igx-grid__tr--expanded", ctx.expandedClass)("igx-grid__tr--highlighted", ctx.highlighted);
    } }, features: [ɵngcc0.ɵɵProvidersFeature([{ provide: IgxRowDirective, useExisting: forwardRef(() => IgxHierarchicalRowComponent) }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 11, vars: 1, consts: [[4, "ngTemplateOutlet"], ["defaultExpandedTemplate", ""], ["defaultCollapsedTemplate", ""], ["defaultEmptyTemplate", ""], ["addTemp", ""], ["defaultTemp", ""], ["fontSet", "material", 3, "isActive"], ["fontSet", "material"], [1, "igx-grid__tr--inner", 3, "animationend"], [3, "ngClass", "click", "mousedown", 4, "ngIf"], [4, "ngIf"], ["igxGridFor", "", 3, "igxGridForOf", "igxForScrollContainer", "igxForSizePropName", "igxForScrollOrientation", "igxForContainerSize", "igxForTrackBy"], ["igxDirRef", ""], ["rowSelectorBaseTemplate", ""], ["pinnedCellsTemplate", ""], [3, "ngClass", "click", "mousedown"], ["expander", ""], [4, "ngTemplateOutlet", "ngTemplateOutletContext"], [3, "igxRowDrag", "ghostTemplate", "click", "pointerdown"], [1, "igx-grid__cbx-selection", 3, "click", "pointerdown"], [1, "igx-grid__td", "igx-grid__td--fw", 3, "ngClass", "ngStyle", "editMode", "column", "formatter", "row", "active", "rowData", "width", "visibleColumnIndex", "value", "cellTemplate", "lastSearchInfo", "cellSelectionMode", "displayPinnedChip"], [1, "igx-grid__cbx-padding"], ["disableRipple", "true", 3, "tabindex", "readonly", "checked", "disabled", "disableTransitions", "aria-label"], ["class", "igx-grid__td igx-grid__td--fw igx-grid__td--pinned", 3, "igx-grid__td--edited", "igx-grid__td--number", "ngClass", "ngStyle", "editMode", "column", "formatter", "row", "active", "firstPinned", "lastPinned", "min-height", "rowData", "min-width", "max-width", "flex-basis", "left", "width", "visibleColumnIndex", "value", "cellTemplate", "lastSearchInfo", "cellSelectionMode", "displayPinnedChip", 4, "ngFor", "ngForOf"], [1, "igx-grid__td", "igx-grid__td--fw", "igx-grid__td--pinned", 3, "ngClass", "ngStyle", "editMode", "column", "formatter", "row", "active", "firstPinned", "lastPinned", "rowData", "width", "visibleColumnIndex", "value", "cellTemplate", "lastSearchInfo", "cellSelectionMode", "displayPinnedChip"]], template: function IgxHierarchicalRowComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, IgxHierarchicalRowComponent_ng_container_0_Template, 1, 0, "ng-container", 0);
        ɵngcc0.ɵɵtemplate(1, IgxHierarchicalRowComponent_ng_template_1_Template, 2, 1, "ng-template", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(3, IgxHierarchicalRowComponent_ng_template_3_Template, 2, 1, "ng-template", null, 2, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(5, IgxHierarchicalRowComponent_ng_template_5_Template, 1, 0, "ng-template", null, 3, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(7, IgxHierarchicalRowComponent_ng_template_7_Template, 2, 3, "ng-template", null, 4, ɵngcc0.ɵɵtemplateRefExtractor);
        ɵngcc0.ɵɵtemplate(9, IgxHierarchicalRowComponent_ng_template_9_Template, 12, 13, "ng-template", null, 5, ɵngcc0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r7 = ɵngcc0.ɵɵreference(8);
        const _r9 = ɵngcc0.ɵɵreference(10);
        ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx.addRow ? _r7 : _r9);
    } }, directives: [ɵngcc1.NgTemplateOutlet, ɵngcc2.IgxIconComponent, ɵngcc1.NgIf, ɵngcc3.IgxGridForOfDirective, ɵngcc1.NgClass, ɵngcc4.IgxRowDragDirective, ɵngcc5.IgxHierarchicalGridCellComponent, ɵngcc1.NgStyle, ɵngcc6.IgxCheckboxComponent, ɵngcc1.NgForOf], pipes: [ɵngcc7.IgxGridNotGroupedPipe, ɵngcc7.IgxGridTransactionStatePipe, ɵngcc7.IgxStringReplacePipe, ɵngcc7.IgxGridCellStyleClassesPipe, ɵngcc7.IgxGridCellStylesPipe, ɵngcc7.IgxGridDataMapperPipe], encapsulation: 2, changeDetection: 0 });
IgxHierarchicalRowComponent.propDecorators = {
    _cells: [{ type: ViewChildren, args: [forwardRef(() => IgxHierarchicalGridCellComponent), { read: IgxHierarchicalGridCellComponent },] }],
    expander: [{ type: ViewChild, args: ['expander', { read: ElementRef },] }],
    defaultExpandedTemplate: [{ type: ViewChild, args: ['defaultExpandedTemplate', { read: TemplateRef, static: true },] }],
    defaultEmptyTemplate: [{ type: ViewChild, args: ['defaultEmptyTemplate', { read: TemplateRef, static: true },] }],
    defaultCollapsedTemplate: [{ type: ViewChild, args: ['defaultCollapsedTemplate', { read: TemplateRef, static: true },] }],
    expandedClass: [{ type: HostBinding, args: ['class.igx-grid__tr--expanded',] }],
    highlighted: [{ type: HostBinding, args: ['class.igx-grid__tr--highlighted',] }]
};
const ɵIgxHierarchicalRowComponent_BaseFactory = /*@__PURE__*/ ɵngcc0.ɵɵgetInheritedFactory(IgxHierarchicalRowComponent);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(IgxHierarchicalRowComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'igx-hierarchical-grid-row',
                template: "\n<ng-container *ngTemplateOutlet='addRow ? addTemp : defaultTemp'></ng-container>\n<ng-template #defaultExpandedTemplate>\n    <igx-icon [isActive]='!added' fontSet=\"material\">expand_more</igx-icon>\n</ng-template>\n\n<ng-template #defaultCollapsedTemplate>\n    <igx-icon [isActive]='!added' fontSet=\"material\">chevron_right</igx-icon>\n</ng-template>\n\n<ng-template #defaultEmptyTemplate>\n    <igx-icon fontSet=\"material\"></igx-icon>\n</ng-template>\n\n<ng-template #addTemp>\n    <div class='igx-grid__tr--inner' [class.igx-grid__tr--add-animate]='animateAdd' (animationend)='animationEndHandler()'>\n        <ng-container *ngTemplateOutlet='defaultTemp'></ng-container>\n    </div>\n</ng-template>\n<ng-template #defaultTemp>\n    <div (click)=\"expanderClick($event)\" (mousedown)='$event.preventDefault()' [ngClass]=\"expanderClassResolved\" *ngIf=\"hasChildren\" #expander>\n            <ng-container *ngTemplateOutlet=\"iconTemplate; context: { $implicit: this }\">\n            </ng-container>\n    </div>\n\n    <ng-container *ngIf=\"rowDraggable\">\n        <div [class]=\"resolveDragIndicatorClasses\" [igxRowDrag]=\"this\" (click)=\"$event.stopPropagation()\" [ghostTemplate]=\"this.grid.getDragGhostCustomTemplate()\" (pointerdown)=\"$event.preventDefault()\">\n                <ng-container *ngTemplateOutlet=\"this.grid.dragIndicatorIconTemplate ? this.grid.dragIndicatorIconTemplate : this.grid.dragIndicatorIconBase\"></ng-container>\n        </div>\n    </ng-container>\n    <ng-container *ngIf=\"showRowSelectors\">\n        <div class=\"igx-grid__cbx-selection\" (click)=\"onRowSelectorClick($event)\" (pointerdown)=\"$event.preventDefault()\">\n            <ng-template *ngTemplateOutlet=\"\n                this.grid.rowSelectorTemplate ? this.grid.rowSelectorTemplate : rowSelectorBaseTemplate;\n                context: { $implicit: {\n                                index: viewIndex,\n                                rowID: rowID,\n                                selected: selected,\n                                select: select,\n                                deselect: deselect }}\">\n            </ng-template>\n        </div>\n    </ng-container>\n\n    <ng-container *ngIf=\"pinnedColumns.length > 0 && grid.isPinningToStart\">\n        <ng-template *ngTemplateOutlet=\"pinnedCellsTemplate; context: this\"></ng-template>\n    </ng-container>\n\n    <ng-template igxGridFor let-col [igxGridForOf]=\"unpinnedColumns | igxNotGrouped\" [igxForScrollContainer]=\"grid.parentVirtDir\" let-colIndex=\"index\" [igxForSizePropName]='\"calcPixelWidth\"' [igxForScrollOrientation]=\"'horizontal'\" [igxForContainerSize]='grid.unpinnedWidth' [igxForTrackBy]='grid.trackColumnChanges' #igxDirRef>\n        <igx-hierarchical-grid-cell\n            class=\"igx-grid__td igx-grid__td--fw\"\n            [class.igx-grid__td--edited]=\"rowID | transactionState:col.field:grid.rowEditable:grid.transactions:grid.pipeTrigger:grid.crudService.cell:grid.crudService.row\"\n            [attr.aria-describedby]=\"gridID + '_' + col.field | igxStringReplace:'.':'_'\"\n            [class.igx-grid__td--number]=\"col.dataType === 'number'\"\n            [class.igx-grid__td--bool]=\"col.dataType === 'boolean'\"\n            [ngClass]=\"col.cellClasses | igxCellStyleClasses:rowData[col.field]:rowData:col.field:viewIndex:grid.pipeTrigger\"\n            [ngStyle]=\"col.cellStyles | igxCellStyles:rowData[col.field]:rowData:col.field:viewIndex:grid.pipeTrigger\"\n            [editMode]=\"col.editable && crudService.targetInEdit(index, col.index)\"\n            [column]=\"col\"\n            [formatter]=\"col.formatter\"\n            [row]=\"this\"\n            [active]=\"isCellActive(col.visibleIndex)\"\n            [style.min-height.px]=\"cellHeight\"\n            [rowData]=\"rowData\"\n            [style.min-width]=\"col.width\"\n            [style.max-width]=\"col.width\"\n            [style.flex-basis]=\"col.width\"\n            [width]=\"col.getCellWidth()\"\n            [visibleColumnIndex]=\"col.visibleIndex\"\n            [value]=\"rowData | dataMapper:col.field:grid.pipeTrigger\"\n            [cellTemplate]=\"col.bodyTemplate\"\n            [lastSearchInfo]=\"grid.lastSearchInfo\"\n            [cellSelectionMode]=\"grid.cellSelection\"\n            [displayPinnedChip]=\"shouldDisplayPinnedChip(col.visibleIndex)\">\n        </igx-hierarchical-grid-cell>\n    </ng-template>\n\n    <ng-container *ngIf=\"pinnedColumns.length > 0 && !grid.isPinningToStart\">\n        <ng-template *ngTemplateOutlet=\"pinnedCellsTemplate; context: this\"></ng-template>\n    </ng-container>\n\n    <ng-template #rowSelectorBaseTemplate>\n        <div class=\"igx-grid__cbx-padding\">\n            <igx-checkbox\n                [tabindex]=\"-1\"\n                [readonly]=\"true\"\n                [checked]=\"selected\"\n                disableRipple=\"true\"\n                [disabled]=\"deleted\"\n                [disableTransitions]=\"grid.disableTransitions\"\n                [aria-label]=\"rowCheckboxAriaLabel\">\n            </igx-checkbox>\n        </div>\n    </ng-template>\n\n    <ng-template #pinnedCellsTemplate let-col>\n        <igx-hierarchical-grid-cell *ngFor=\"let col of pinnedColumns | igxNotGrouped\"\n            class=\"igx-grid__td igx-grid__td--fw igx-grid__td--pinned\"\n            [class.igx-grid__td--edited]=\"rowID | transactionState:col.field:grid.rowEditable:grid.transactions:grid.pipeTrigger:grid.crudService.cell:grid.crudService.row\"\n            [attr.aria-describedby]=\"gridID + '_' + col.field | igxStringReplace:'.':'_'\"\n            [class.igx-grid__td--number]=\"col.dataType === 'number'\"\n            [ngClass]=\"col.cellClasses | igxCellStyleClasses:rowData[col.field]:rowData:col.field:viewIndex:grid.pipeTrigger\"\n            [ngStyle]=\"col.cellStyles | igxCellStyles:rowData[col.field]:rowData:col.field:viewIndex:grid.pipeTrigger\"\n            [editMode]=\"col.editable && crudService.targetInEdit(index, col.index)\"\n            [column]=\"col\"\n            [formatter]=\"col.formatter\"\n            [row]=\"this\"\n            [active]=\"isCellActive(col.visibleIndex)\"\n            [firstPinned]=\"col.isFirstPinned\"\n            [lastPinned]=\"col.isLastPinned\"\n            [style.min-height.px]=\"cellHeight\"\n            [rowData]=\"rowData\"\n            [style.min-width]=\"col.width\"\n            [style.max-width]=\"col.width\"\n            [style.flex-basis]=\"col.width\"\n            [style.left]=\"col.rightPinnedOffset\"\n            [width]=\"col.getCellWidth()\"\n            [visibleColumnIndex]=\"col.visibleIndex\"\n            [value]=\"rowData | dataMapper:col.field:grid.pipeTrigger\"\n            [cellTemplate]=\"col.bodyTemplate\"\n            [lastSearchInfo]=\"grid.lastSearchInfo\"\n            [cellSelectionMode]=\"grid.cellSelection\"\n            [displayPinnedChip]=\"shouldDisplayPinnedChip(col.visibleIndex)\">\n        </igx-hierarchical-grid-cell>\n    </ng-template>\n</ng-template>",
                providers: [{ provide: IgxRowDirective, useExisting: forwardRef(() => IgxHierarchicalRowComponent) }]
            }]
    }], null, { expandedClass: [{
            type: HostBinding,
            args: ['class.igx-grid__tr--expanded']
        }], highlighted: [{
            type: HostBinding,
            args: ['class.igx-grid__tr--highlighted']
        }], _cells: [{
            type: ViewChildren,
            args: [forwardRef(() => IgxHierarchicalGridCellComponent), { read: IgxHierarchicalGridCellComponent }]
        }], expander: [{
            type: ViewChild,
            args: ['expander', { read: ElementRef }]
        }], defaultExpandedTemplate: [{
            type: ViewChild,
            args: ['defaultExpandedTemplate', { read: TemplateRef, static: true }]
        }], defaultEmptyTemplate: [{
            type: ViewChild,
            args: ['defaultEmptyTemplate', { read: TemplateRef, static: true }]
        }], defaultCollapsedTemplate: [{
            type: ViewChild,
            args: ['defaultCollapsedTemplate', { read: TemplateRef, static: true }]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGllcmFyY2hpY2FsLXJvdy5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2lnbml0ZXVpLWFuZ3VsYXIvc3JjL2xpYi9ncmlkcy9oaWVyYXJjaGljYWwtZ3JpZC9oaWVyYXJjaGljYWwtcm93LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0gsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFDVCxXQUFXLEVBQ1gsVUFBVSxFQUNWLFVBQVUsRUFDVixZQUFZLEVBRVosU0FBUyxFQUNULFdBQVcsRUFDZCxNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbkQsT0FBTyxFQUFFLGdDQUFnQyxFQUFFLE1BQU0sK0JBQStCLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFRakYsTUFBTSxPQUFPLDJCQUE0QixTQUFRLGVBQTZDO0FBQzlGLElBUEE7QUFDRztBQUE2QixRQU9sQixrQkFBYSxHQUFHLGlDQUFpQyxDQUFDO0FBQ2hFLFFBNkZJO0FBQ0o7QUFDSTtBQUVKLFdBRE87QUFDUCxRQUFXLFdBQU0sR0FBRyxHQUFHLEVBQUU7QUFDekIsWUFBUSxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQzNDLFFBQUksQ0FBQyxDQUFBO0FBQ0wsUUFDSTtBQUNKO0FBQ0k7QUFFSixXQURPO0FBQ1AsUUFBVyxhQUFRLEdBQUcs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QUFDLFVBQVUsRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUU7QUFDMUMsc0NBU0QsU0FBUyxTQUFDLHlCQUF5QixFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO0FBQ3ZFLG1DQUtELFNBQVMsU0FBQyxzQkFBc0IsRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtBQUNwRSx1Q0FLRCxTQUFTLFNBQUMsMEJBQTBCLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFDeEUsNEJBZUEsV0FBVyxTQUFDLDhCQUE4QjtBQUMxQywwQkFXQSxXQUFXLFNBQUMsaUNBQWlDO0FBQzlDOzs7Ozs7O3M0QkF2RWdELGtCQUNoRCxTQUFTLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxlQUFlLEVBQUUsV0FBVyxFQUFFLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQywyQkFBMkIsQ0FBQyxFQUFFLENBQUMsY0FDeEc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFxRUs7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gICAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gICAgQ29tcG9uZW50LFxuICAgIEhvc3RCaW5kaW5nLFxuICAgIGZvcndhcmRSZWYsXG4gICAgRWxlbWVudFJlZixcbiAgICBWaWV3Q2hpbGRyZW4sXG4gICAgUXVlcnlMaXN0LFxuICAgIFZpZXdDaGlsZCxcbiAgICBUZW1wbGF0ZVJlZlxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IElneEhpZXJhcmNoaWNhbEdyaWRDb21wb25lbnQgfSBmcm9tICcuL2hpZXJhcmNoaWNhbC1ncmlkLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBJZ3hSb3dEaXJlY3RpdmUgfSBmcm9tICcuLi9yb3cuZGlyZWN0aXZlJztcbmltcG9ydCB7IElneEhpZXJhcmNoaWNhbEdyaWRDZWxsQ29tcG9uZW50IH0gZnJvbSAnLi9oaWVyYXJjaGljYWwtY2VsbC5jb21wb25lbnQnO1xuXG5AQ29tcG9uZW50KHtcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICBzZWxlY3RvcjogJ2lneC1oaWVyYXJjaGljYWwtZ3JpZC1yb3cnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9oaWVyYXJjaGljYWwtcm93LmNvbXBvbmVudC5odG1sJyxcbiAgICBwcm92aWRlcnM6IFt7IHByb3ZpZGU6IElneFJvd0RpcmVjdGl2ZSwgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gSWd4SGllcmFyY2hpY2FsUm93Q29tcG9uZW50KSB9XVxufSlcbmV4cG9ydCBjbGFzcyBJZ3hIaWVyYXJjaGljYWxSb3dDb21wb25lbnQgZXh0ZW5kcyBJZ3hSb3dEaXJlY3RpdmU8SWd4SGllcmFyY2hpY2FsR3JpZENvbXBvbmVudD4ge1xuXG4gICAgcHJvdGVjdGVkIGV4cGFuZGVyQ2xhc3MgPSAnaWd4LWdyaWRfX2hpZXJhcmNoaWNhbC1leHBhbmRlcic7XG5cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcHVibGljIGdldCBleHBhbmRlckNsYXNzUmVzb2x2ZWQoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBbdGhpcy5leHBhbmRlckNsYXNzXTogIXRoaXMucGlubmVkIHx8IHRoaXMuZGlzYWJsZWQsXG4gICAgICAgICAgICBbYCR7dGhpcy5leHBhbmRlckNsYXNzfS0tZW1wdHlgXTogdGhpcy5waW5uZWQgJiYgIXRoaXMuZGlzYWJsZWRcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBAVmlld0NoaWxkcmVuKGZvcndhcmRSZWYoKCkgPT4gSWd4SGllcmFyY2hpY2FsR3JpZENlbGxDb21wb25lbnQpLCB7IHJlYWQ6IElneEhpZXJhcmNoaWNhbEdyaWRDZWxsQ29tcG9uZW50IH0pXG4gICAgcHJvdGVjdGVkIF9jZWxsczogUXVlcnlMaXN0PElneEhpZXJhcmNoaWNhbEdyaWRDZWxsQ29tcG9uZW50PjtcblxuICAgIEBWaWV3Q2hpbGQoJ2V4cGFuZGVyJywgeyByZWFkOiBFbGVtZW50UmVmIH0pXG4gICAgcHVibGljIGV4cGFuZGVyOiBFbGVtZW50UmVmPEhUTUxFbGVtZW50PjtcblxuICAgIGdldCB2aWV3SW5kZXgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXggKyB0aGlzLmdyaWQucGFnZSAqIHRoaXMuZ3JpZC5wZXJQYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgIEBWaWV3Q2hpbGQoJ2RlZmF1bHRFeHBhbmRlZFRlbXBsYXRlJywgeyByZWFkOiBUZW1wbGF0ZVJlZiwgc3RhdGljOiB0cnVlIH0pXG4gICBwcm90ZWN0ZWQgZGVmYXVsdEV4cGFuZGVkVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICBAVmlld0NoaWxkKCdkZWZhdWx0RW1wdHlUZW1wbGF0ZScsIHsgcmVhZDogVGVtcGxhdGVSZWYsIHN0YXRpYzogdHJ1ZSB9KVxuICAgcHJvdGVjdGVkIGRlZmF1bHRFbXB0eVRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgQFZpZXdDaGlsZCgnZGVmYXVsdENvbGxhcHNlZFRlbXBsYXRlJywgeyByZWFkOiBUZW1wbGF0ZVJlZiwgc3RhdGljOiB0cnVlIH0pXG4gICBwcm90ZWN0ZWQgZGVmYXVsdENvbGxhcHNlZFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSByb3cgaXMgZXhwYW5kZWQuXG4gICAgICogYGBgdHlwZXNjcmlwdFxuICAgICAqIGNvbnN0IFJvd0V4cGFuZGVkID0gdGhpcy5ncmlkMS5yb3dMaXN0LmZpcnN0LmV4cGFuZGVkO1xuICAgICAqIGBgYFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgZXhwYW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdyaWRBUEkuZ2V0X3Jvd19leHBhbnNpb25fc3RhdGUodGhpcy5yb3dEYXRhKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQEhvc3RCaW5kaW5nKCdjbGFzcy5pZ3gtZ3JpZF9fdHItLWV4cGFuZGVkJylcbiAgICBwdWJsaWMgZ2V0IGV4cGFuZGVkQ2xhc3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV4cGFuZGVkICYmICF0aGlzLnBpbm5lZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGhhc0NoaWxkcmVuKCkge1xuICAgICAgICByZXR1cm4gICEhdGhpcy5ncmlkLmNoaWxkTGF5b3V0S2V5cy5sZW5ndGg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEBIb3N0QmluZGluZygnY2xhc3MuaWd4LWdyaWRfX3RyLS1oaWdobGlnaHRlZCcpXG4gICAgcHVibGljIGdldCBoaWdobGlnaHRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ3JpZCAmJiB0aGlzLmdyaWQuaGlnaGxpZ2h0ZWRSb3dJRCA9PT0gdGhpcy5yb3dJRDtcbiAgICB9XG5cbiAgIC8qKlxuICAgICogQGhpZGRlblxuICAgICovXG4gICBwdWJsaWMgZXhwYW5kZXJDbGljayhldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdGhpcy50b2dnbGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUb2dnbGVzIHRoZSBoaWVyYXJjaGljYWwgcm93LlxuICAgICAqIGBgYHR5cGVzY3JpcHRcbiAgICAgKiB0aGlzLmdyaWQxLnJvd0xpc3QuZmlyc3QudG9nZ2xlKClcbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBwdWJsaWMgdG9nZ2xlKCkge1xuICAgICAgICBpZiAodGhpcy5hZGRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGdyaWQgPSB0aGlzLmdyaWRBUEkuZ3JpZDtcbiAgICAgICAgdGhpcy5lbmRFZGl0KGdyaWQucm9vdEdyaWQpO1xuICAgICAgICB0aGlzLmdyaWRBUEkuc2V0X3Jvd19leHBhbnNpb25fc3RhdGUodGhpcy5yb3dJRCwgIXRoaXMuZXhwYW5kZWQpO1xuICAgICAgICBncmlkLmNkci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHB1YmxpYyBzZWxlY3QgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuZ3JpZC5zZWxlY3RSb3dzKFt0aGlzLnJvd0lEXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHB1YmxpYyBkZXNlbGVjdCA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5ncmlkLmRlc2VsZWN0Um93cyhbdGhpcy5yb3dJRF0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGljb25UZW1wbGF0ZSgpIHtcbiAgICAgICAgbGV0IGV4cGFuZGFibGUgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5ncmlkLmhhc0NoaWxkcmVuS2V5KSB7XG4gICAgICAgICAgICBleHBhbmRhYmxlID0gdGhpcy5yb3dEYXRhW3RoaXMuZ3JpZC5oYXNDaGlsZHJlbktleV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFleHBhbmRhYmxlIHx8ICh0aGlzLnBpbm5lZCAmJiAhdGhpcy5kaXNhYmxlZCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRFbXB0eVRlbXBsYXRlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmV4cGFuZGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ncmlkLnJvd0V4cGFuZGVkSW5kaWNhdG9yVGVtcGxhdGUgfHwgdGhpcy5kZWZhdWx0RXhwYW5kZWRUZW1wbGF0ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdyaWQucm93Q29sbGFwc2VkSW5kaWNhdG9yVGVtcGxhdGUgfHwgdGhpcy5kZWZhdWx0Q29sbGFwc2VkVGVtcGxhdGU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZW5kRWRpdChncmlkOiBJZ3hIaWVyYXJjaGljYWxHcmlkQ29tcG9uZW50KSB7XG4gICAgICAgIGlmIChncmlkLmNydWRTZXJ2aWNlLmNlbGxJbkVkaXRNb2RlKSB7XG4gICAgICAgICAgICBncmlkLmVuZEVkaXQoKTtcbiAgICAgICAgfVxuICAgICAgICBncmlkLmhncmlkQVBJLmdldENoaWxkR3JpZHModHJ1ZSkuZm9yRWFjaChnID0+IHtcbiAgICAgICAgICAgIGlmIChnLmNydWRTZXJ2aWNlLmNlbGxJbkVkaXRNb2RlKSB7XG4gICAgICAgICAgICBnLmVuZEVkaXQoKTtcbiAgICAgICAgfX0pO1xuICAgIH1cbn1cbiJdfQ==